{"ast":null,"code":"import axios from \"axios\";\nimport { toast } from \"react-toastify\";\nimport configFile from \"../config.json\";\nimport authService from \"./auth.service\";\nimport localStorageService from \"./localStorage.service\";\nconst http = axios.create({\n  baseURL: configFile.apiEndpoint\n});\nhttp.interceptors.request.use(async function (config) {\n  const expiresDate = localStorageService.getTokenExpiresDate();\n  const refreshToken = localStorageService.getRefreshToken();\n  const isExpired = refreshToken && expiresDate < Date.now();\n  if (isExpired) {\n    const data = await authService.refresh(config);\n    localStorageService.setTokens(data);\n  }\n  const accessToken = localStorageService.getAccessToken();\n  if (accessToken) {\n    config.headers = {\n      ...config.headers,\n      Authorization: `Bearer ${accessToken}`\n    };\n  }\n  console.log(\"config\", config);\n  return config;\n}, function (error) {\n  return Promise.reject(error);\n});\nhttp.interceptors.response.use(res => {\n  res.data = {\n    content: res.data\n  };\n  return res;\n}, function (error) {\n  const expectedErrors = error.response && error.response.status >= 400 && error.response.status < 500;\n  if (!expectedErrors) {\n    console.log(error.message);\n    toast.error(\"Somthing was wrong. Try it later\");\n  }\n  return Promise.reject(error);\n});\nconst httpService = {\n  get: http.get,\n  post: http.post,\n  put: http.put,\n  delete: http.delete,\n  patch: http.patch\n};\nexport default httpService;","map":{"version":3,"names":["axios","toast","configFile","authService","localStorageService","http","create","baseURL","apiEndpoint","interceptors","request","use","config","expiresDate","getTokenExpiresDate","refreshToken","getRefreshToken","isExpired","Date","now","data","refresh","setTokens","accessToken","getAccessToken","headers","Authorization","console","log","error","Promise","reject","response","res","content","expectedErrors","status","message","httpService","get","post","put","delete","patch"],"sources":["/Users/maksimrogozin/Documents/VScode/workout_diplom/WORKOUT/client/src/app/services/http.service.js"],"sourcesContent":["import axios from \"axios\";\nimport { toast } from \"react-toastify\";\nimport configFile from \"../config.json\";\nimport authService from \"./auth.service\";\nimport localStorageService from \"./localStorage.service\";\n\nconst http = axios.create({\n  baseURL: configFile.apiEndpoint,\n});\n\nhttp.interceptors.request.use(\n  async function (config) {\n    const expiresDate = localStorageService.getTokenExpiresDate();\n    const refreshToken = localStorageService.getRefreshToken();\n    const isExpired = refreshToken && expiresDate < Date.now();\n\n    if (isExpired) {\n      const data = await authService.refresh(config);\n\n      localStorageService.setTokens(data);\n    }\n    const accessToken = localStorageService.getAccessToken();\n    if (accessToken) {\n      config.headers = {\n        ...config.headers,\n        Authorization: `Bearer ${accessToken}`,\n      };\n    }\n    console.log(\"config\", config);\n    return config;\n  },\n  function (error) {\n    return Promise.reject(error);\n  }\n);\nhttp.interceptors.response.use(\n  (res) => {\n    res.data = { content: res.data };\n    return res;\n  },\n  function (error) {\n    const expectedErrors =\n      error.response &&\n      error.response.status >= 400 &&\n      error.response.status < 500;\n\n    if (!expectedErrors) {\n      console.log(error.message);\n      toast.error(\"Somthing was wrong. Try it later\");\n    }\n    return Promise.reject(error);\n  }\n);\nconst httpService = {\n  get: http.get,\n  post: http.post,\n  put: http.put,\n  delete: http.delete,\n  patch: http.patch,\n};\n\nexport default httpService;\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,KAAK,QAAQ,gBAAgB;AACtC,OAAOC,UAAU,MAAM,gBAAgB;AACvC,OAAOC,WAAW,MAAM,gBAAgB;AACxC,OAAOC,mBAAmB,MAAM,wBAAwB;AAExD,MAAMC,IAAI,GAAGL,KAAK,CAACM,MAAM,CAAC;EACxBC,OAAO,EAAEL,UAAU,CAACM;AACtB,CAAC,CAAC;AAEFH,IAAI,CAACI,YAAY,CAACC,OAAO,CAACC,GAAG,CAC3B,gBAAgBC,MAAM,EAAE;EACtB,MAAMC,WAAW,GAAGT,mBAAmB,CAACU,mBAAmB,CAAC,CAAC;EAC7D,MAAMC,YAAY,GAAGX,mBAAmB,CAACY,eAAe,CAAC,CAAC;EAC1D,MAAMC,SAAS,GAAGF,YAAY,IAAIF,WAAW,GAAGK,IAAI,CAACC,GAAG,CAAC,CAAC;EAE1D,IAAIF,SAAS,EAAE;IACb,MAAMG,IAAI,GAAG,MAAMjB,WAAW,CAACkB,OAAO,CAACT,MAAM,CAAC;IAE9CR,mBAAmB,CAACkB,SAAS,CAACF,IAAI,CAAC;EACrC;EACA,MAAMG,WAAW,GAAGnB,mBAAmB,CAACoB,cAAc,CAAC,CAAC;EACxD,IAAID,WAAW,EAAE;IACfX,MAAM,CAACa,OAAO,GAAG;MACf,GAAGb,MAAM,CAACa,OAAO;MACjBC,aAAa,EAAG,UAASH,WAAY;IACvC,CAAC;EACH;EACAI,OAAO,CAACC,GAAG,CAAC,QAAQ,EAAEhB,MAAM,CAAC;EAC7B,OAAOA,MAAM;AACf,CAAC,EACD,UAAUiB,KAAK,EAAE;EACf,OAAOC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAC9B,CACF,CAAC;AACDxB,IAAI,CAACI,YAAY,CAACuB,QAAQ,CAACrB,GAAG,CAC3BsB,GAAG,IAAK;EACPA,GAAG,CAACb,IAAI,GAAG;IAAEc,OAAO,EAAED,GAAG,CAACb;EAAK,CAAC;EAChC,OAAOa,GAAG;AACZ,CAAC,EACD,UAAUJ,KAAK,EAAE;EACf,MAAMM,cAAc,GAClBN,KAAK,CAACG,QAAQ,IACdH,KAAK,CAACG,QAAQ,CAACI,MAAM,IAAI,GAAG,IAC5BP,KAAK,CAACG,QAAQ,CAACI,MAAM,GAAG,GAAG;EAE7B,IAAI,CAACD,cAAc,EAAE;IACnBR,OAAO,CAACC,GAAG,CAACC,KAAK,CAACQ,OAAO,CAAC;IAC1BpC,KAAK,CAAC4B,KAAK,CAAC,kCAAkC,CAAC;EACjD;EACA,OAAOC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAC9B,CACF,CAAC;AACD,MAAMS,WAAW,GAAG;EAClBC,GAAG,EAAElC,IAAI,CAACkC,GAAG;EACbC,IAAI,EAAEnC,IAAI,CAACmC,IAAI;EACfC,GAAG,EAAEpC,IAAI,CAACoC,GAAG;EACbC,MAAM,EAAErC,IAAI,CAACqC,MAAM;EACnBC,KAAK,EAAEtC,IAAI,CAACsC;AACd,CAAC;AAED,eAAeL,WAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}