{"ast":null,"code":"import { createSlice } from \"@reduxjs/toolkit\";\nimport catalogService from \"../services/catalog.service\";\n\n// const initialState = localStorageService.getAccessToken()\n//   ? {\n//       entities: null,\n//       isLoading: true,\n//       error: null,\n//       auth: { userId: localStorageService.getUserId() },\n//       isLoggedIn: true,\n//       dataLoaded: false,\n//     }\n//   : {\n//       entities: null,\n//       isLoading: false,\n//       error: null,\n//       auth: null,\n//       isLoggedIn: false,\n//       dataLoaded: false,\n//     };\n\nconst catalogsSlice = createSlice({\n  name: \"catalogs\",\n  initialState: {\n    entities: null,\n    isLoading: true,\n    error: null\n  },\n  reducers: {\n    catalogsRequested: state => {\n      state.isLoading = true;\n    },\n    catalogsReceived: (state, action) => {\n      state.entities = action.payload;\n      state.isLoading = false;\n    },\n    catalogsRequestFailed: (state, action) => {\n      state.error = action.payload;\n      state.isLoading = false;\n    },\n    incrementProductCount: (state, action) => {\n      const {\n        payload: productId\n      } = action;\n      const product = state.entities.find(entity => entity._id === productId);\n      if (product) {\n        product.count += 1;\n      }\n    },\n    decrementProductCount: (state, action) => {\n      const {\n        payload: productId\n      } = action;\n      const product = state.entities.find(entity => entity._id === productId);\n      if (product.count > 1) {\n        product.count -= 1;\n      }\n    },\n    deleteProductCount: (state, action) => {\n      const {\n        payload: productId\n      } = action;\n      const product = state.entities.find(entity => entity._id === productId);\n      if (product) {\n        product.count = 0;\n      }\n    }\n  }\n});\nconst {\n  reducer: catalogsReducer,\n  actions\n} = catalogsSlice;\nconst {\n  catalogsRequested,\n  catalogsReceived,\n  catalogsRequestFailed,\n  incrementProductCount,\n  decrementProductCount,\n  deleteProductCount\n} = actions;\nexport const loadCatalogsList = () => async dispatch => {\n  dispatch(catalogsRequested());\n  try {\n    const {\n      content\n    } = await catalogService.get();\n    dispatch(catalogsReceived(content));\n  } catch (error) {\n    dispatch(catalogsRequestFailed(error.message));\n  }\n};\nexport const incrementCount = productId => dispatch => {\n  dispatch(incrementProductCount(productId));\n};\nexport const decrementCount = productId => dispatch => {\n  dispatch(decrementProductCount(productId));\n};\nexport const deleteCount = productId => dispatch => {\n  dispatch(deleteProductCount(productId));\n  removeObjectFromArrayById(productId);\n};\nexport const getCatalogsList = () => state => state.catalogs.entities;\nexport const getCatalogsLoadingStatus = () => state => state.catalogs.isLoading;\nexport const getCatalogsById = productId => state => {\n  if (state.catalogs.entities) {\n    return state.catalogs.entities.find(entity => entity._id === productId);\n  }\n};\nexport const getBasket = () => state => {\n  if (state.catalogs.entities) {\n    const res = state.catalogs.entities.filter(entity => entity.count !== 0);\n    return res;\n  }\n};\nexport const getAllCount = state => {\n  let result = 0;\n  if (state.catalogs.entities) {\n    state.catalogs.entities.forEach(({\n      count\n    }) => {\n      result += count;\n    });\n  }\n  return result;\n};\nexport const getTotalPrice = state => {\n  let result = 0;\n  if (state.catalogs.entities) {\n    state.catalogs.entities.forEach(({\n      count,\n      price\n    }) => {\n      result += count * price;\n    });\n  }\n  return result;\n};\nexport default catalogsReducer;","map":{"version":3,"names":["createSlice","catalogService","catalogsSlice","name","initialState","entities","isLoading","error","reducers","catalogsRequested","state","catalogsReceived","action","payload","catalogsRequestFailed","incrementProductCount","productId","product","find","entity","_id","count","decrementProductCount","deleteProductCount","reducer","catalogsReducer","actions","loadCatalogsList","dispatch","content","get","message","incrementCount","decrementCount","deleteCount","removeObjectFromArrayById","getCatalogsList","catalogs","getCatalogsLoadingStatus","getCatalogsById","getBasket","res","filter","getAllCount","result","forEach","getTotalPrice","price"],"sources":["/Users/maksimrogozin/Documents/VScode/workout_diplom/WORKOUT/client/src/app/store/catalog.js"],"sourcesContent":["import { createSlice } from \"@reduxjs/toolkit\";\nimport catalogService from \"../services/catalog.service\";\n\n// const initialState = localStorageService.getAccessToken()\n//   ? {\n//       entities: null,\n//       isLoading: true,\n//       error: null,\n//       auth: { userId: localStorageService.getUserId() },\n//       isLoggedIn: true,\n//       dataLoaded: false,\n//     }\n//   : {\n//       entities: null,\n//       isLoading: false,\n//       error: null,\n//       auth: null,\n//       isLoggedIn: false,\n//       dataLoaded: false,\n//     };\n\nconst catalogsSlice = createSlice({\n  name: \"catalogs\",\n  initialState: {\n    entities: null,\n    isLoading: true,\n    error: null,\n  },\n  reducers: {\n    catalogsRequested: (state) => {\n      state.isLoading = true;\n    },\n    catalogsReceived: (state, action) => {\n      state.entities = action.payload;\n      state.isLoading = false;\n    },\n    catalogsRequestFailed: (state, action) => {\n      state.error = action.payload;\n      state.isLoading = false;\n    },\n    incrementProductCount: (state, action) => {\n      const { payload: productId } = action;\n      const product = state.entities.find((entity) => entity._id === productId);\n      if (product) {\n        product.count += 1;\n      }\n    },\n    decrementProductCount: (state, action) => {\n      const { payload: productId } = action;\n      const product = state.entities.find((entity) => entity._id === productId);\n      if (product.count > 1) {\n        product.count -= 1;\n      }\n    },\n    deleteProductCount: (state, action) => {\n      const { payload: productId } = action;\n      const product = state.entities.find((entity) => entity._id === productId);\n      if (product) {\n        product.count = 0;\n      }\n    },\n  },\n});\n\nconst { reducer: catalogsReducer, actions } = catalogsSlice;\nconst {\n  catalogsRequested,\n  catalogsReceived,\n  catalogsRequestFailed,\n  incrementProductCount,\n  decrementProductCount,\n  deleteProductCount,\n} = actions;\n\nexport const loadCatalogsList = () => async (dispatch) => {\n  dispatch(catalogsRequested());\n  try {\n    const { content } = await catalogService.get();\n    dispatch(catalogsReceived(content));\n  } catch (error) {\n    dispatch(catalogsRequestFailed(error.message));\n  }\n};\n\nexport const incrementCount = (productId) => (dispatch) => {\n  dispatch(incrementProductCount(productId));\n};\n\nexport const decrementCount = (productId) => (dispatch) => {\n  dispatch(decrementProductCount(productId));\n};\n\nexport const deleteCount = (productId) => (dispatch) => {\n  dispatch(deleteProductCount(productId));\n  removeObjectFromArrayById(productId);\n};\n\nexport const getCatalogsList = () => (state) => state.catalogs.entities;\n\nexport const getCatalogsLoadingStatus = () => (state) =>\n  state.catalogs.isLoading;\n\nexport const getCatalogsById = (productId) => (state) => {\n  if (state.catalogs.entities) {\n    return state.catalogs.entities.find((entity) => entity._id === productId);\n  }\n};\n\nexport const getBasket = () => (state) => {\n  if (state.catalogs.entities) {\n    const res = state.catalogs.entities.filter((entity) => entity.count !== 0);\n    return res;\n  }\n};\n\nexport const getAllCount = (state) => {\n  let result = 0;\n  if (state.catalogs.entities) {\n    state.catalogs.entities.forEach(({ count }) => {\n      result += count;\n    });\n  }\n  return result;\n};\n\nexport const getTotalPrice = (state) => {\n  let result = 0;\n  if (state.catalogs.entities) {\n    state.catalogs.entities.forEach(({ count, price }) => {\n      result += count * price;\n    });\n  }\n  return result;\n};\n\nexport default catalogsReducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}